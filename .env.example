# ==============================================================================
# Fouler Play v2 - Environment Configuration
# ==============================================================================
# Copy this file to .env (or .env.deku, .env.bakugo for multi-bot setups)
# and fill in your specific values.
#
# For running multiple bots simultaneously (e.g., DEKU and BAKUGO):
# - Each bot should use its own .env file
# - Set different PS_USERNAME and BOT_DISPLAY_NAME for each
# - Adjust MAX_CONCURRENT_BATTLES and SEARCH_PARALLELISM per bot
# ==============================================================================

# === REQUIRED: Pokemon Showdown Credentials ===
PS_USERNAME=YOUR_USERNAME_HERE
PS_PASSWORD=YOUR_PASSWORD_HERE

# Pokemon Showdown WebSocket URI
# Default: wss://sim3.psim.us/showdown/websocket
PS_WEBSOCKET_URI=wss://sim3.psim.us/showdown/websocket

# Battle format to play (e.g., gen9ou, gen9randombattle, gen8ou)
PS_FORMAT=gen9ou

# Bot mode (used by run.py if passed via environment instead of CLI)
# Options: search_ladder, challenge_user, accept_challenge
PS_BOT_MODE=search_ladder

# How long to search for each move (milliseconds)
# Lower = faster decisions, higher = potentially better play
# Recommended: 2000-3000ms for ladder play
PS_SEARCH_TIME_MS=2000

# === Decision Policy (Eval vs Hybrid) ===
# DECISION_POLICY:
# - eval   = existing deterministic eval/heuristic policy only
# - hybrid = eval generates candidates, OpenAI reranks among top candidates
DECISION_POLICY=eval

# OpenAI key used for live hybrid decisions (required when DECISION_POLICY=hybrid)
OPENAI_API_KEY_PLAYER=

# OpenAI key reserved for learner/offline analysis jobs (optional)
OPENAI_API_KEY_LEARNER=

# Backward-compatible single key alias (used if OPENAI_API_KEY_PLAYER is unset)
OPENAI_API_KEY=

# OpenAI model for hybrid reranking
OPENAI_MODEL=gpt-4.1-mini

# Optional custom API base (default works for OpenAI cloud)
OPENAI_API_BASE=https://api.openai.com/v1

# LLM rerank call timeout in seconds (keep low to avoid turn timer pressure)
LLM_TIMEOUT_SEC=3.0

# Number of top eval candidates provided to the LLM for reranking
LLM_RERANK_TOP_K=5

# Hybrid request backoff (seconds) after API 429 rate-limit responses
HYBRID_RATE_LIMIT_BACKOFF_SEC=120

# Skip LLM rerank on clear-best turns to save tokens/rate-limit budget.
# Rerank only when top choices are close.
HYBRID_CLEAR_BEST_RATIO=1.35
HYBRID_CLEAR_BEST_DELTA=0.15

# Number of battles to run before stopping (999999 = effectively infinite)
PS_RUN_COUNT=999999

# === Team Configuration ===
# TEAM_LIST: Path to file containing team paths (one per line)
# Example: fat-teams.list contains paths like "gen9/ou/fat-team-1-stall"
TEAM_LIST=fat-teams.list

# TEAM_NAME: Single team to use (mutually exclusive with TEAM_LIST)
# TEAM_NAME=gen9/ou/fat-team-1-stall

# TEAM_NAMES: Comma-separated list for per-worker team assignment
# TEAM_NAMES=gen9/ou/fat-team-1-stall,gen9/ou/fat-team-2-pivot,gen9/ou/fat-team-3-dondozo

# === Battle Parallelization ===
# How many battles to run simultaneously
# Recommended: 1
MAX_CONCURRENT_BATTLES=1

# How many worker processes to spawn for battle search
# Higher = more CPU usage, faster search (if you have cores available)
# Recommended for user mode: 1
SEARCH_PARALLELISM=1

# === Logging Configuration ===
# Log level for console output
# Options: DEBUG, INFO, WARNING, ERROR
BOT_LOG_LEVEL=INFO

# Whether to write logs to files (1=yes, 0=no)
# Logs are written to logs/ directory with rotation (10MB max, 3 backups)
BOT_LOG_TO_FILE=1

# === Discord Integration (Optional) ===
# Bot display name for Discord messages (helps distinguish multiple bots)
# Examples: "ðŸª² DEKU", "ðŸ’¥ BAKUGO", "Your Bot Name"
BOT_DISPLAY_NAME=ðŸª² DEKU

# Discord webhook for project updates/general bot status
DISCORD_WEBHOOK_URL=

# Discord webhook for battle result notifications
DISCORD_BATTLES_WEBHOOK_URL=

# Discord webhook for turn review feedback
DISCORD_FEEDBACK_WEBHOOK_URL=

# === Process Management (Advanced) ===
# Parent process PID (used by bot_monitor to detect if spawner dies)
# FP_PARENT_PID=12345

# How often to check if parent is alive (seconds)
# FP_PARENT_CHECK_SEC=5

# Enable automatic drain mode after losses
# When enabled, bot stops queueing new battles after a loss
# Options: 1, true, yes (enabled) or 0, false, no (disabled)
LOSS_TRIGGERED_DRAIN=1

# Timeout for drain mode to complete (seconds)
# DRAIN_TIMEOUT_SEC=300

# Hard stop for a single battle in seconds.
# Set to 0 to never force-terminate long stall games (recommended for evaluation).
BATTLE_HARD_TIMEOUT_SEC=0

# === OBS Spectator Account (Optional) ===
# Separate PS account to use for spectating in OBS
# If set, OBS should log into this account instead of the bot account
# This prevents OBS from auto-switching to the bot's active battle
SPECTATOR_USERNAME=

# Disable stream hooks by default for user-only bot play
ENABLE_STREAM_HOOKS=0

# Invites are enabled automatically when SPECTATOR_USERNAME is set.
# Set this to 0/false/no/off only if you want to explicitly disable invites.
ENABLE_SPECTATOR_INVITES=1

# Auto-start the local OBS helper server from start_one_touch.bat
# (serves /idle + /overlay/hybrid and updates Battle Slot URLs via OBS WebSocket).
AUTO_START_OBS_SERVER=1

# === Session Management (Advanced) ===
# Whether to resume active battles on restart
# SESSION_REBASE_ON_START=1

# ==============================================================================
# Multi-Bot Setup Example
# ==============================================================================
# To run two bots simultaneously (e.g., DEKU on Linux, BAKUGO on Windows):
#
# 1. Create .env.deku:
#    PS_USERNAME=BugInTheCode
#    BOT_DISPLAY_NAME=ðŸª² DEKU
#    MAX_CONCURRENT_BATTLES=3
#    SEARCH_PARALLELISM=4
#
# 2. Create .env.bakugo:
#    PS_USERNAME=LADDERANNIHILATOR
#    BOT_DISPLAY_NAME=ðŸ’¥ BAKUGO
#    MAX_CONCURRENT_BATTLES=2
#    SEARCH_PARALLELISM=2
#
# 3. Each bot loads its own .env file using:
#    cp .env.deku .env    (on DEKU's machine)
#    cp .env.bakugo .env  (on BAKUGO's machine)
#
# Both can share the same Discord webhooks to post to the same channels.
# ==============================================================================
